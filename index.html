<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- PWA / Home screen icon -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <meta name="theme-color" content="#37003c">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="FPL Analyzer">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>FPL Team Analysis</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="theme.js"></script>
    <script src="lang.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <style>
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           GUARDIAN OVERLAY â€” full-viewport onboarding screen
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #fpl-guardian {
            position: fixed; inset: 0; z-index: 9990;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden;
            /* Stadium background */
            background-image:
                linear-gradient(180deg, rgba(6,2,14,0.62) 0%, rgba(4,12,6,0.74) 60%, rgba(2,6,3,0.90) 100%),
                url('https://images.unsplash.com/photo-1522778119026-d647f0596c20?w=1920&q=80');
            background-size: cover;
            background-position: center 30%;
        }
        #fpl-guardian.guardian-hidden { display: none; }

        /* â”€â”€ Moving light beams â”€â”€ */
        .g-light {
            position: absolute; pointer-events: none;
            border-radius: 50%;
            filter: blur(80px);
            mix-blend-mode: screen;
            opacity: 0;
            animation: lightDrift linear infinite;
        }
        .g-light-1 {
            width: 420px; height: 420px;
            background: radial-gradient(circle, rgba(255,255,180,0.13) 0%, transparent 70%);
            top: -10%; left: 5%;
            animation-duration: 22s;
            animation-delay: 0s;
        }
        .g-light-2 {
            width: 320px; height: 320px;
            background: radial-gradient(circle, rgba(0,255,135,0.10) 0%, transparent 70%);
            top: 5%; right: 10%;
            animation-duration: 31s;
            animation-delay: -8s;
        }
        .g-light-3 {
            width: 260px; height: 260px;
            background: radial-gradient(circle, rgba(180,220,255,0.09) 0%, transparent 70%);
            bottom: 10%; left: 20%;
            animation-duration: 27s;
            animation-delay: -14s;
        }
        .g-light-4 {
            width: 200px; height: 200px;
            background: radial-gradient(circle, rgba(255,200,100,0.07) 0%, transparent 70%);
            bottom: 20%; right: 15%;
            animation-duration: 36s;
            animation-delay: -5s;
        }
        @keyframes lightDrift {
            0%   { opacity: 0;    transform: translate(0, 0)       scale(1);    }
            8%   { opacity: 1; }
            45%  { opacity: 1;    transform: translate(60px, 40px)  scale(1.15); }
            55%  { opacity: 1;    transform: translate(-30px, 70px) scale(0.90); }
            92%  { opacity: 1; }
            100% { opacity: 0;    transform: translate(20px, -20px) scale(1.05); }
        }
        #fpl-guardian::after {
            content: ''; position: absolute; inset: 0; pointer-events: none;
            background:
                radial-gradient(ellipse 60% 40% at 50% 55%, rgba(0,255,135,0.06) 0%, transparent 70%),
                radial-gradient(ellipse 80% 30% at 50% 100%, rgba(4,12,6,0.7) 0%, transparent 100%);
        }

        .guardian-card {
            position: relative; z-index: 2;
            width: 100%; max-width: 460px; margin: 16px;
            background: rgba(6, 2, 16, 0.82);
            backdrop-filter: blur(32px); -webkit-backdrop-filter: blur(32px);
            border: 1px solid rgba(0,255,135,0.18); border-radius: 24px;
            padding: 40px 36px 28px;
            box-shadow: 0 40px 100px rgba(0,0,0,0.85), 0 0 0 1px rgba(255,255,255,0.04),
                        inset 0 1px 0 rgba(255,255,255,0.05);
            max-height: 95vh; overflow-y: auto;
            scrollbar-width: thin; scrollbar-color: rgba(0,255,135,0.25) transparent;
        }
        /* â”€â”€ Mobile: smaller card so stadium bg shows â”€â”€ */
        @media (max-width: 520px) {
            .guardian-card {
                max-width: 340px;
                padding: 24px 20px 20px;
                border-radius: 18px;
                margin: 12px;
            }
            .guardian-crest { width: 50px; height: 68px; margin-bottom: 10px; }
            .guardian-title { font-size: 1.45rem; }
            .guardian-sub   { font-size: 0.78rem; }
            .guardian-brand { margin-bottom: 18px; }
            .guardian-input { padding: 10px 13px; font-size: 1rem; }
            .guardian-btn   { padding: 11px 20px; font-size: 0.9rem; }
        }
        .guardian-brand { text-align: left; margin-bottom: 26px; }
        .guardian-crest {
            display: inline-flex; align-items: center; justify-content: center;
            width: 62px; height: 85px; /* 44:60 ratio with stars */
            margin-bottom: 15px;
            filter: drop-shadow(0 8px 22px rgba(0,255,135,0.26))
                    drop-shadow(0 2px 6px rgba(0,0,0,0.5));
        }
        .guardian-crest svg { width: 100%; height: 100%; display: block; overflow: visible; }
        .guardian-eyebrow {
            font-size: 0.72rem; letter-spacing: 0.15em; text-transform: uppercase;
            color: #00ff87; margin: 0 0 6px; font-weight: 600;
        }
        .guardian-title {
            font-family: 'Oswald', sans-serif; font-size: clamp(1.7rem, 5vw, 2.3rem);
            font-weight: 700; color: #fff; margin: 0 0 6px; line-height: 1.1;
        }
        .guardian-sub { font-size: 0.88rem; color: rgba(255,255,255,0.43); margin: 0; line-height: 1.5; }
        .guardian-form { margin-bottom: 2px; }
        .guardian-label {
            display: block; font-size: 0.71rem; font-weight: 700; letter-spacing: 0.1em;
            text-transform: uppercase; color: rgba(255,255,255,0.42); margin-bottom: 8px;
        }
        .guardian-input {
            display: block; width: 100%; box-sizing: border-box;
            padding: 13px 16px;
            background: rgba(255,255,255,0.05); border: 1.5px solid rgba(255,255,255,0.11);
            border-radius: 12px; color: #fff; font-size: 1.15rem;
            font-family: 'Oswald', monospace; letter-spacing: 0.06em; outline: none;
            transition: border-color .2s, box-shadow .2s, background .2s;
        }
        .guardian-input:focus {
            border-color: #00ff87; background: rgba(0,255,135,0.04);
            box-shadow: 0 0 0 3px rgba(0,255,135,0.12);
        }
        .guardian-input::placeholder { color: rgba(255,255,255,0.2); }
        .guardian-input::-webkit-outer-spin-button,
        .guardian-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .guardian-input[type=number] { -moz-appearance: textfield; }
        .guardian-btn {
            display: block; width: 100%; margin-top: 12px; padding: 13px 24px;
            background: linear-gradient(135deg, #00ff87 0%, #00cc6a 100%);
            border: none; border-radius: 12px; color: #160022;
            font-size: 1rem; font-weight: 700; font-family: 'Oswald', sans-serif;
            letter-spacing: 0.05em; cursor: pointer;
            transition: opacity .2s, transform .15s, box-shadow .2s;
            box-shadow: 0 6px 24px rgba(0,255,135,0.28);
        }
        .guardian-btn:disabled { opacity: .28; cursor: not-allowed; box-shadow: none; }
        .guardian-btn:not(:disabled):hover { transform: translateY(-2px); box-shadow: 0 12px 36px rgba(0,255,135,0.44); }
        .guardian-btn:not(:disabled):active { transform: translateY(0); }
        .guardian-how { margin-top: 22px; border-top: 1px solid rgba(255,255,255,0.07); padding-top: 16px; }
        .guardian-how > summary {
            cursor: pointer; list-style: none; display: flex; align-items: center; gap: 8px;
            font-size: 0.82rem; font-weight: 600; color: rgba(255,255,255,0.4);
            user-select: none; transition: color .2s; padding: 2px 0;
        }
        .guardian-how > summary::-webkit-details-marker { display: none; }
        .guardian-how > summary::before { content: 'â–¶'; font-size: .6em; transition: transform .2s; display: inline-block; }
        .guardian-how[open] > summary::before { transform: rotate(90deg); }
        .guardian-how[open] > summary { color: rgba(255,255,255,0.68); }
        .guardian-steps {
            margin: 12px 0 0 4px; padding-left: 20px;
            color: rgba(255,255,255,0.55); font-size: 0.83rem; line-height: 1.9;
        }
        .guardian-steps li { padding-left: 4px; }
        .guardian-steps strong { color: #e2e8f0; }
        .guardian-steps code {
            background: rgba(0,255,135,0.1); color: #00ff87;
            padding: 1px 7px; border-radius: 4px; font-size: .82em; font-family: monospace;
        }
        .guardian-tip { margin: 10px 0 0; font-size: .78rem; color: rgba(255,255,255,0.3); line-height: 1.5; padding-left: 4px; }
        .guardian-lang {
            display: flex; justify-content: center; gap: 10px;
            margin-top: 20px; padding-top: 16px; border-top: 1px solid rgba(255,255,255,0.07);
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           CHANGE TEAM ID MODAL
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .modal-overlay {
            position: fixed; inset: 0; z-index: 9980;
            background: rgba(0,0,0,0.65); backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: flex; align-items: center; justify-content: center;
        }
        .modal-overlay[hidden] { display: none !important; }
        .modal-box {
            background: var(--bg-surface, #14092a);
            border: 1px solid rgba(0,255,135,0.22); border-radius: 20px;
            padding: 30px 28px 24px; width: 100%; max-width: 360px; margin: 20px;
            box-shadow: 0 32px 80px rgba(0,0,0,0.7), inset 0 1px 0 rgba(255,255,255,0.06);
        }
        .modal-box h3 {
            color: #fff; font-family: 'Oswald', sans-serif;
            font-size: 1.25rem; letter-spacing: .03em; margin: 0 0 18px;
        }
        .modal-actions { display: flex; gap: 10px; margin-top: 12px; }
        .modal-actions .guardian-btn { flex: 1; margin-top: 0; font-size: .88rem; padding: 11px; }
        .modal-cancel-btn {
            flex: 1; padding: 11px; background: transparent;
            border: 1.5px solid rgba(255,255,255,0.15); border-radius: 12px;
            color: rgba(255,255,255,0.5); font-size: .88rem; font-family: sans-serif;
            cursor: pointer; transition: border-color .2s, color .2s;
        }
        .modal-cancel-btn:hover { border-color: rgba(255,255,255,0.4); color: #fff; }

        /* Header logo mark â€” top-left corner, mirrors lang-switcher position */
        .header-logo {
            position: absolute;
            top: 10px;
            left: 14px;
            display: inline-flex; align-items: center; justify-content: center;
            width: 32px; height: 41px; /* 44:60 ratio */
            flex-shrink: 0; z-index: 10;
            filter: drop-shadow(0 2px 10px rgba(0,255,135,0.28));
        }
        .header-logo svg { width: 100%; height: 100%; display: block; overflow: visible; }
        .header-content { display: block; }
        /* Change ID button â€” inside header, bottom-right corner */
        #change-team-btn {
            position: absolute;
            bottom: 6px;
            right: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 2px 8px 2px 6px;
            background: rgba(255,255,255,0.07);
            border: 1px solid rgba(0,255,135,0.20);
            border-radius: 20px;
            color: rgba(255,255,255,0.38);
            font-size: 0.68rem;
            font-family: 'Oswald', sans-serif;
            font-weight: 600;
            letter-spacing: 0.06em;
            text-transform: uppercase;
            cursor: pointer;
            transition: background .2s, border-color .2s, color .2s;
            z-index: 2;
        }
        #change-team-btn::before { content: 'âš™'; font-size: 0.62rem; opacity: .7; }
        #change-team-btn:hover {
            background: rgba(0,255,135,0.10);
            border-color: rgba(0,255,135,0.55);
            color: #00ff87;
        }
    </style>
</head>
<body>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         FPL ANALYZER LOGO â€” reusable SVG symbol
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display:none" aria-hidden="true">
        <symbol id="fpl-logo" viewBox="0 -10 44 60">
            <!-- â”€â”€ THREE GOLD STARS (crown arrangement) â”€â”€ -->
            <polygon points="9,-5 9.71,-2.97 11.85,-2.93 10.14,-1.63 10.76,0.43 9,-0.8 7.24,0.43 7.86,-1.63 6.15,-2.93 8.29,-2.97"
                     fill="#ffc324" opacity="0.92"/>
            <polygon points="22,-8 22.71,-5.97 24.85,-5.93 23.14,-4.63 23.76,-2.57 22,-3.8 20.24,-2.57 20.86,-4.63 19.15,-5.93 21.29,-5.97"
                     fill="#ffc324" opacity="0.92"/>
            <polygon points="35,-5 35.71,-2.97 37.85,-2.93 36.14,-1.63 36.76,0.43 35,-0.8 33.24,0.43 33.86,-1.63 32.15,-2.93 34.29,-2.97"
                     fill="#ffc324" opacity="0.92"/>
            <!-- â”€â”€ CREST SHIELD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <path d="M22 2C22 2 40 7 40 16L40 31Q40 48 22 50Q4 48 4 31L4 16C4 7 22 2 22 2Z"
                  fill="#1a0830" fill-opacity="0.88"
                  stroke="#00ff87" stroke-width="1.35" stroke-linejoin="round"/>

            <!-- â”€â”€ TOP HEADER BAND (classic badge strip) â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <path d="M4 16L4 23L22 19L40 23L40 16Z" fill="#00ff87" fill-opacity="0.08"/>
            <line x1="4" y1="23" x2="40" y2="23" stroke="#00ff87" stroke-width="0.7" opacity="0.28"/>

            <!-- Corner accent dots in header band -->
            <circle cx="10" cy="15.5" r="1.4" fill="#00ff87" opacity="0.55"/>
            <circle cx="34" cy="15.5" r="1.4" fill="#00ff87" opacity="0.55"/>

            <!-- Diamond ornament â€” top-centre of shield -->
            <polygon points="22,4 24,8 22,12 20,8" fill="#00ff87" opacity="0.65"/>

            <!-- â”€â”€ FOOTBALL TEXTURE (subtle, behind bars) â”€â”€â”€â”€â”€â”€â”€ -->
            <!-- ball circle -->
            <circle cx="22" cy="36.5" r="11.5" fill="none" stroke="#00ff87" stroke-width="0.9" opacity="0.10"/>
            <!-- central pentagon (top-facing panel) -->
            <polygon points="22,32 25.9,34.2 24.4,38.5 19.6,38.5 18.1,34.2"
                     fill="rgba(0,255,135,0.04)" stroke="#00ff87" stroke-width="0.65" opacity="0.16"/>
            <!-- 5 seam lines from pentagon vertices to ball edge -->
            <path d="M22,32 C21,28.5 18.5,26.5 16,25" fill="none" stroke="#00ff87" stroke-width="0.6" opacity="0.12"/>
            <path d="M25.9,34.2 C28.5,32 31.5,32 33.5,30" fill="none" stroke="#00ff87" stroke-width="0.6" opacity="0.12"/>
            <path d="M24.4,38.5 C26,41.5 24.5,44.5 22,46" fill="none" stroke="#00ff87" stroke-width="0.6" opacity="0.12"/>
            <path d="M19.6,38.5 C18,41.5 19.5,44.5 22,46" fill="none" stroke="#00ff87" stroke-width="0.6" opacity="0.12"/>
            <path d="M18.1,34.2 C15.5,32 12.5,32 10.5,30" fill="none" stroke="#00ff87" stroke-width="0.6" opacity="0.12"/>

            <!-- â”€â”€ DATA BARS (foreground) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <rect x="9.5"  y="32"  width="5.5" height="12" rx="1.5" fill="#00ff87" opacity="0.44"/>
            <rect x="18"   y="25"  width="5.5" height="19" rx="1.5" fill="#00ff87" opacity="0.72"/>
            <rect x="26.5" y="18"  width="5.5" height="26" rx="1.5" fill="#00ff87"/>
            <!-- bar-top highlights -->
            <line x1="9.5"  y1="32" x2="15"   y2="32" stroke="#fff" stroke-width="0.8" opacity="0.20" stroke-linecap="round"/>
            <line x1="18"   y1="25" x2="23.5" y2="25" stroke="#fff" stroke-width="0.8" opacity="0.20" stroke-linecap="round"/>
            <line x1="26.5" y1="18" x2="32"   y2="18" stroke="#fff" stroke-width="0.8" opacity="0.20" stroke-linecap="round"/>
        </symbol>
    </svg>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         FPL GUARDIAN â€” first-visit onboarding overlay
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="fpl-guardian">
        <!-- Moving light blobs -->
        <div class="g-light g-light-1" aria-hidden="true"></div>
        <div class="g-light g-light-2" aria-hidden="true"></div>
        <div class="g-light g-light-3" aria-hidden="true"></div>
        <div class="g-light g-light-4" aria-hidden="true"></div>
        <!-- Main card -->
        <div class="guardian-card">
            <div class="guardian-brand">
                <div class="guardian-crest" aria-label="FPL Analyzer logo">
                    <svg><use href="#fpl-logo"/></svg>
                </div>
                <p class="guardian-eyebrow" data-i18n="appEyebrow">Fantasy Premier League</p>
                <h1 class="guardian-title" data-i18n="appTitle">FPL Team Analyzer</h1>
                <p class="guardian-sub" data-i18n="guardianSubtitle">Your personal FPL intelligence hub</p>
            </div>
            <div class="guardian-form">
                <label class="guardian-label" for="guardian-input" data-i18n="guardianInputLabel">Enter your FPL Team ID</label>
                <input type="number" id="guardian-input" class="guardian-input" min="1" max="9999999"
                       data-i18n="guardianInputPlaceholder" data-i18n-attr="placeholder" placeholder="e.g. 1234567" />
                <button id="guardian-continue" class="guardian-btn" disabled data-i18n="guardianContinue">Continue â†’</button>
            </div>
            <details class="guardian-how">
                <summary><span data-i18n="guardianHowTitle">How to find your Team ID</span></summary>
                <ol class="guardian-steps">
                    <li data-i18n-html="guardianStep1"></li>
                    <li data-i18n-html="guardianStep2"></li>
                    <li data-i18n-html="guardianStep3"></li>
                    <li data-i18n-html="guardianStep4"></li>
                </ol>
                <p class="guardian-tip" data-i18n-html="guardianTip"></p>
            </details>
            <div class="guardian-lang">
                <button class="lang-btn" data-lang="en" onclick="setLang('en')" title="English">ğŸ‡¬ğŸ‡§</button>
                <button class="lang-btn" data-lang="sr" onclick="setLang('sr')" title="Srpski">ğŸ‡·ğŸ‡¸</button>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <div class="header-logo" aria-label="FPL Analyzer logo">
                <svg><use href="#fpl-logo"/></svg>
            </div>
            <div class="header-content">
                <span class="header-eyebrow" data-i18n="appEyebrow">Fantasy Premier League</span>
                <h1 id="team-name-header">FPL Team Analyzer</h1>
                <p class="team-subtitle" id="team-subtitle"></p>
            </div>
            <div class="lang-switcher">
                <button class="lang-btn" data-lang="en" onclick="setLang('en')" title="English">ğŸ‡¬ğŸ‡§</button>
                <button class="lang-btn" data-lang="sr" onclick="setLang('sr')" title="Srpski">ğŸ‡·ğŸ‡¸</button>
            </div>
            <button id="theme-toggle" class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>
            <span id="tid-badge"></span>
            <button id="change-team-btn" onclick="openChangeModal()" data-i18n="changeTeamId" title="Change FPL Team ID">Change ID</button>
        </header>

        <div class="cards-grid">
            <!-- My Team Card -->
            <div class="card" data-card="team">
                <div class="card-header">
                    <h2 data-i18n="cardMyTeam">My Team</h2>
                    <button class="expand-btn" onclick="openCardPage('team.html')">â¤¢</button>
                </div>
                <div class="card-content" id="team-content">
                    <div class="loading" data-i18n="loadingTeam">Loading team data...</div>
                </div>
            </div>

            <!-- Performance Analytics Card -->
            <div class="card" data-card="performance">
                <div class="card-header">
                    <h2 data-i18n="cardPerformance">Performance Analytics</h2>
                    <button class="expand-btn" onclick="openCardPage('performance.html')">â¤¢</button>
                </div>
                <div class="card-content" id="performance-content">
                    <div class="loading" data-i18n="loadingPerf">Loading performance data...</div>
                </div>
            </div>

            <!-- Player Database Card -->
            <div class="card card-large" data-card="database">
                <div class="card-header">
                    <h2 data-i18n="cardDatabase">Player Database</h2>
                    <button class="expand-btn" onclick="openCardPage('database.html')">â¤¢</button>
                </div>
                <div class="card-content" id="database-content">
                    <div class="search-container">
                        <input type="text" id="player-search" data-i18n="searchPlaceholder" data-i18n-attr="placeholder" placeholder="Search players by name, team, or position..." />
                        <select id="position-filter">
                            <option value="" data-i18n="allPositions">All Positions</option>
                            <option value="GKP" data-i18n="goalkeeper">Goalkeeper</option>
                            <option value="DEF" data-i18n="defender">Defender</option>
                            <option value="MID" data-i18n="midfielder">Midfielder</option>
                            <option value="FWD" data-i18n="forward">Forward</option>
                        </select>
                        <select id="team-filter">
                            <option value="" data-i18n="allTeams">All Teams</option>
                        </select>
                    </div>
                    <div class="table-container">
                        <table id="players-table" class="table-compact">
                            <thead>
                                <tr>
                                    <th onclick="sortTable('name')" data-i18n="colName">Name â†•</th>
                                    <th onclick="sortTable('team')" class="col-hide-sm" data-i18n="colTeam">Team â†•</th>
                                    <th onclick="sortTable('position')" class="col-hide-sm" data-i18n="colPosition">Position â†•</th>
                                    <th onclick="sortTable('price')" class="col-hide-sm" data-i18n="colPrice">Price â†•</th>
                                    <th onclick="sortTable('points')" data-i18n="colPoints">Points â†•</th>
                                    <th onclick="sortTable('form')" data-i18n="colForm">Form â†•</th>
                                    <th onclick="sortTable('goalsScored')" class="col-hide-md" data-i18n="colGoals">Goals â†•</th>
                                    <th onclick="sortTable('assists')" class="col-hide-md" data-i18n="colAssists">Assists â†•</th>
                                    <th onclick="sortTable('expectedGoalInvolvements')" class="col-hide-lg" data-i18n="colXGI">Exp. G+A â†•</th>
                                    <th onclick="sortTable('tackles')" class="col-hide-lg" data-i18n="colTackles">Tackles â†•</th>
                                    <th onclick="sortTable('selectedBy')" class="col-hide-lg" data-i18n="colOwned">Owned By% â†•</th>
                                </tr>
                            </thead>
                            <tbody id="players-tbody">
                                <tr><td colspan="11" class="loading" data-i18n="loadingPlayers">Loading players...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Points Prediction Card -->
            <div class="card" data-card="prediction">
                <div class="card-header">
                    <h2 data-i18n="cardPrediction">Points Prediction</h2>
                    <button class="expand-btn" onclick="openCardPage('prediction.html')">â¤¢</button>
                </div>
                <div class="card-content" id="prediction-content">
                    <div class="loading" data-i18n="loadingPredictions">Calculating predictions...</div>
                </div>
            </div>

            <!-- Transfer Suggestions Card -->
            <div class="card" data-card="transfers">
                <div class="card-header">
                    <h2 data-i18n="cardTransfers">Transfer Suggestions</h2>
                    <button class="expand-btn" onclick="openCardPage('transfers.html')">â¤¢</button>
                </div>
                <div class="card-content" id="transfers-content">
                    <div class="loading" data-i18n="loadingTransfers">Analyzing transfers...</div>
                </div>
            </div>
            <!-- Player Comparison Card -->
            <div class="card" data-card="comparison">
                <div class="card-header">
                    <h2 data-i18n="cardComparison">Player Comparison</h2>
                    <button class="expand-btn" onclick="openCardPage('comparison.html')">&#10562;</button>
                </div>
                <div class="card-content" id="comparison-content">
                    <div class="compare-search-row">
                        <input type="text" class="compare-input" id="cmp-input-0" data-i18n="cmpPlayer1" data-i18n-attr="placeholder" placeholder="Player 1..." autocomplete="off" oninput="handleCompareSearch(0)" />
                        <input type="text" class="compare-input" id="cmp-input-1" data-i18n="cmpPlayer2" data-i18n-attr="placeholder" placeholder="Player 2..." autocomplete="off" oninput="handleCompareSearch(1)" />
                        <input type="text" class="compare-input" id="cmp-input-2" data-i18n="cmpPlayer3" data-i18n-attr="placeholder" placeholder="Player 3 (optional)" autocomplete="off" oninput="handleCompareSearch(2)" />
                    </div>
                    <div id="cmp-dropdowns">
                        <div class="cmp-dropdown" id="cmp-dd-0"></div>
                        <div class="cmp-dropdown" id="cmp-dd-1"></div>
                        <div class="cmp-dropdown" id="cmp-dd-2"></div>
                    </div>
                    <div id="cmp-result"><p class="cmp-hint" data-i18n="cmpHint">Search and select up to 3 players to compare their FPL stats.</p></div>
                </div>
            </div>        </div>
    </div>

    <style>
        #tid-badge {
            position: absolute;
            bottom: 7px;
            left: 10px;
            font-size: 9px;
            opacity: 0.22;
            color: #fff;
            letter-spacing: 0.04em;
            pointer-events: none;
            z-index: 2;
            font-family: monospace;
            user-select: none;
        }
    </style>
    <script src="fpl-api.js"></script>
    <script src="prediction.js"></script>
    <script src="app.js"></script>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         CHANGE TEAM ID MODAL
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="change-id-modal" class="modal-overlay" hidden>
        <div class="modal-box">
            <h3 data-i18n="changeTeamIdTitle">Change FPL Team ID</h3>
            <input type="number" id="change-id-input" class="guardian-input" min="1" max="9999999"
                   data-i18n="guardianInputPlaceholder" data-i18n-attr="placeholder" placeholder="e.g. 1234567" />
            <div class="modal-actions">
                <button id="change-id-save" class="guardian-btn" onclick="saveNewTeamId()" data-i18n="changeTeamIdSave">Save &amp; Reload</button>
                <button class="modal-cancel-btn" onclick="closeChangeModal()" data-i18n="changeTeamIdCancel">Cancel</button>
            </div>
        </div>
    </div>

    <script>
    // â”€â”€â”€ Guardian / Team ID Management â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    (function guardianInit() {
        const STORAGE_KEY = 'fpl_team_id';

        function updateBadge(id) {
            const badge = document.getElementById('tid-badge');
            if (badge) badge.textContent = `id:${id}`;
        }

        function initGuardian() {
            const storedId = localStorage.getItem(STORAGE_KEY);
            const guardian = document.getElementById('fpl-guardian');

            if (storedId && /^\d{4,}$/.test(storedId.trim())) {
                // ID already known â€” app.js DOMContentLoaded already started initializeApp
                FPL_API.TEAM_ID = parseInt(storedId, 10);
                guardian.classList.add('guardian-hidden');
                updateBadge(storedId);
                return;
            }

            // No valid ID â€” show guardian; app.js checks localStorage so it won't auto-start
            applyI18n();
            const input = document.getElementById('guardian-input');
            const btn   = document.getElementById('guardian-continue');

            input.addEventListener('input', () => {
                btn.disabled = !(input.value.trim().length >= 4);
            });
            btn.addEventListener('click', () => {
                const id = input.value.trim();
                if (!id) return;
                localStorage.setItem(STORAGE_KEY, id);
                FPL_API.TEAM_ID = parseInt(id, 10);
                guardian.classList.add('guardian-hidden');
                updateBadge(id);
                initializeApp();
            });
            input.addEventListener('keydown', e => {
                if (e.key === 'Enter' && !btn.disabled) btn.click();
            });
        }

        // â”€â”€ Change Team ID modal â”€â”€
        window.openChangeModal = function () {
            const modal = document.getElementById('change-id-modal');
            const input = document.getElementById('change-id-input');
            const btn   = document.getElementById('change-id-save');
            applyI18n(); // re-apply translations in case language changed
            input.value = localStorage.getItem(STORAGE_KEY) || '';
            btn.disabled = !(input.value.trim().length >= 4);
            modal.removeAttribute('hidden');
            input.focus();
            input.select();
            input.oninput = () => { btn.disabled = !(input.value.trim().length >= 4); };
        };

        window.closeChangeModal = function () {
            document.getElementById('change-id-modal').setAttribute('hidden', '');
        };

        window.saveNewTeamId = function () {
            const id = document.getElementById('change-id-input').value.trim();
            if (!id) return;
            localStorage.setItem(STORAGE_KEY, id);
            FPL_API.TEAM_ID = parseInt(id, 10);
            FPL_API.cache   = { bootstrap: null, teamData: null, fixtures: null, managerHistory: null };
            closeChangeModal();
            updateBadge(id);
            initializeApp();
        };

        // Close modal when clicking backdrop
        document.getElementById('change-id-modal').addEventListener('click', function (e) {
            if (e.target === this) closeChangeModal();
        });
        document.addEventListener('keydown', e => { if (e.key === 'Escape') closeChangeModal(); });

        document.addEventListener('DOMContentLoaded', initGuardian);
    }());
    </script>

    <footer class="site-footer" data-i18n-html="footerHtml">
        <span data-i18n="footerText">Made with</span> <span class="heart">&#x2665;</span> <span data-i18n="footerBy">for you by</span> <strong>Srdjan Kojic</strong>
    </footer>
</body>
</html>
